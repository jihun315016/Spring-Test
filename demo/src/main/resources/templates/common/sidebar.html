<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<section th:fragment="sidebar">
    <div id="sidebar-menu" class="main_menu_side hidden-print main_menu">
        <div class="menu_section">
            <h3>General</h3>
            <ul class="nav side-menu">
                <li><a><i class="fa fa-home"></i> Home <span class="fa fa-chevron-down"></span></a>
                    <ul class="nav child_menu">
                        <li><a href="index.html">Dashboard</a></li>
                        <li><a href="index2.html">Dashboard2</a></li>
                        <li><a href="index3.html">Dashboard3</a></li>
                    </ul>
                </li>
                <li><a><i class="fa fa-edit"></i> Forms <span class="fa fa-chevron-down"></span></a>
                    <ul class="nav child_menu">
                        <li><a href="form.html">General Form</a></li>
                        <li><a href="form_advanced.html">Advanced Components</a></li>
                        <li><a href="form_validation.html">Form Validation</a></li>
                        <li><a href="form_wizards.html">Form Wizard</a></li>
                        <li><a href="form_upload.html">Form Upload</a></li>
                        <li><a href="form_buttons.html">Form Buttons</a></li>
                    </ul>
                </li>
                <li><a><i class="fa fa-desktop"></i> UI Elements <span
                        class="fa fa-chevron-down"></span></a>
                    <ul class="nav child_menu">
                        <li><a href="general_elements.html">General Elements</a></li>
                        <li><a href="media_gallery.html">Media Gallery</a></li>
                        <li><a href="typography.html">Typography</a></li>
                        <li><a href="icons.html">Icons</a></li>
                        <li><a href="glyphicons.html">Glyphicons</a></li>
                        <li><a href="widgets.html">Widgets</a></li>
                        <li><a href="invoice.html">Invoice</a></li>
                        <li><a href="inbox.html">Inbox</a></li>
                        <li><a href="calendar.html">Calendar</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>

    <script>
        // 컨트롤러에서 메뉴 데이터를 요청하는 부분
        fetch('/menu', { method: 'GET' })
        .then(response => response.json())
        .then(data => {
            // 메뉴 데이터를 이용해 HTML 요소 생성
            console.log(data);
        })
        .catch(error => console.error(error));


        // 1. 타겟 요소를 선택합니다.
        const sidebarContainer = document.getElementById('sidebar-menu');

        // 2. 새로운 HTML 요소를 생성합니다.
        const sidebarMenu = document.createElement('div');
        sidebarMenu.classList.add('menu_section');

        // 3. 제목 요소를 생성하고 추가합니다.
        const sidebarTitle = document.createElement('h3');
        sidebarTitle.textContent = 'General';
        sidebarMenu.appendChild(sidebarTitle);

        // 4. 메뉴 목록 요소를 생성하고 추가합니다.
        const sidebarList = document.createElement('ul');
        sidebarList.classList.add('nav', 'side-menu');

        // 5. 각 메뉴 항목을 생성하고 추가합니다.
        const menuItems = [
        { icon: 'fa fa-home', label: 'Home', subItems: ['Dashboard', 'Dashboard2', 'Dashboard3'] },
        { icon: 'fa fa-edit', label: 'Forms', subItems: ['General Form', 'Advanced Components', 'Form Validation', 'Form Wizard', 'Form Upload', 'Form Buttons'] },
        { icon: 'fa fa-desktop', label: 'UI Elements', subItems: ['General Elements', 'Media Gallery', 'Typography', 'Icons', 'Glyphicons', 'Widgets', 'Invoice', 'Inbox', 'Calendar'] }
        ];

        menuItems.forEach(item => {
        const menuItem = document.createElement('li');
        const menuLink = document.createElement('a');
        const menuIcon = document.createElement('i');
        
        const tokens = 'fa fa-home'.split(' ');
        tokens.forEach(token => menuIcon.classList.add(token));
        menuLink.appendChild(menuIcon);
        menuLink.appendChild(document.createTextNode(` ${item.label} `));
        const menuChevron = document.createElement('span');
        menuChevron.classList.add('fa', 'fa-chevron-down');
        menuLink.appendChild(menuChevron);
        menuItem.appendChild(menuLink);

        if (item.subItems.length > 0) {
            const subMenu = document.createElement('ul');
            subMenu.classList.add('nav', 'child_menu');
            item.subItems.forEach(subItem => {
            const subMenuItem = document.createElement('li');
            const subMenuLink = document.createElement('a');
            subMenuLink.href = `${subItem.toLowerCase().replace(' ', '')}.html`;
            subMenuLink.textContent = subItem;
            subMenuItem.appendChild(subMenuLink);
            subMenu.appendChild(subMenuItem);
            });
            menuItem.appendChild(subMenu);
        }

        sidebarList.appendChild(menuItem);
        });

        sidebarMenu.appendChild(sidebarList);
        sidebarContainer.appendChild(sidebarMenu);

        console.log(sidebarContainer)
    </script>
</section>
</html>